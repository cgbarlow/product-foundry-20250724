
> ravis-adventure@1.0.0 test
> jest

FAIL tests/save-load.test.js
  Save/Load System
    Basic Save Functionality
      âœ“ should save game state successfully (1 ms)
      âœ“ should include all relevant game state in save
      âœ“ should handle saving empty/minimal state (1 ms)
    Basic Load Functionality
      âœ• should load saved game state successfully
      âœ• should restore complex game state accurately (1 ms)
      âœ“ should handle loading non-existent save gracefully (1 ms)
    Save/Load Cycle Integrity
      âœ• should maintain data integrity through multiple save/load cycles
      âœ“ should handle rapid save/load operations (2 ms)
      âœ“ should preserve character state through saves
    Save File Management
      âœ• should handle different save file names (1 ms)
      âœ• should overwrite existing saves
      âœ• should handle save file corruption gracefully
    Data Validation
      âœ“ should validate save data structure
      âœ“ should handle invalid state data gracefully
      âœ• should preserve data types correctly
    Performance and Scalability
      âœ• should handle large save files efficiently (1 ms)
      âœ• should maintain performance with multiple saves
    Edge Cases and Error Recovery
      âœ“ should handle concurrent save/load operations
      âœ“ should recover from interrupted save operations
      âœ• should handle saves with special characters

  â— Save/Load System â€º Basic Load Functionality â€º should load saved game state successfully

    Save file not found

      183 |       return Promise.resolve()
      184 |     }
    > 185 |     throw new Error('Save file not found')
          |           ^
      186 |   }
      187 |   
      188 |   async resetGame() {

      at MockGameEngine.loadGame (tests/mocks/game-engine.mock.js:185:11)
      at Object.loadGame (tests/save-load.test.js:110:24)

  â— Save/Load System â€º Basic Load Functionality â€º should restore complex game state accurately

    Save file not found

      183 |       return Promise.resolve()
      184 |     }
    > 185 |     throw new Error('Save file not found')
          |           ^
      186 |   }
      187 |   
      188 |   async resetGame() {

      at MockGameEngine.loadGame (tests/mocks/game-engine.mock.js:185:11)
      at Object.loadGame (tests/save-load.test.js:156:24)

  â— Save/Load System â€º Save/Load Cycle Integrity â€º should maintain data integrity through multiple save/load cycles

    Save file not found

      183 |       return Promise.resolve()
      184 |     }
    > 185 |     throw new Error('Save file not found')
          |           ^
      186 |   }
      187 |   
      188 |   async resetGame() {

      at MockGameEngine.loadGame (tests/mocks/game-engine.mock.js:185:11)
      at Object.loadGame (tests/save-load.test.js:189:26)

  â— Save/Load System â€º Save File Management â€º should handle different save file names

    Save file not found

      183 |       return Promise.resolve()
      184 |     }
    > 185 |     throw new Error('Save file not found')
          |           ^
      186 |   }
      187 |   
      188 |   async resetGame() {

      at MockGameEngine.loadGame (tests/mocks/game-engine.mock.js:185:11)
      at Object.loadGame (tests/save-load.test.js:263:26)

  â— Save/Load System â€º Save File Management â€º should overwrite existing saves

    Save file not found

      183 |       return Promise.resolve()
      184 |     }
    > 185 |     throw new Error('Save file not found')
          |           ^
      186 |   }
      187 |   
      188 |   async resetGame() {

      at MockGameEngine.loadGame (tests/mocks/game-engine.mock.js:185:11)
      at Object.loadGame (tests/save-load.test.js:281:24)

  â— Save/Load System â€º Save File Management â€º should handle save file corruption gracefully

    expect(received).rejects.toThrow()

    Received promise resolved instead of rejected
    Resolved to value: undefined

      294 |       
      295 |       // Loading corrupted save should fail gracefully
    > 296 |       await expect(gameEngine.loadGame('corrupted_save')).rejects.toThrow()
          |             ^
      297 |       
      298 |       // Game should remain in a valid state
      299 |       const state = gameEngine.getState()

      at expect (node_modules/expect/build/index.js:113:15)
      at Object.expect (tests/save-load.test.js:296:13)

  â— Save/Load System â€º Data Validation â€º should preserve data types correctly

    Save file not found

      183 |       return Promise.resolve()
      184 |     }
    > 185 |     throw new Error('Save file not found')
          |           ^
      186 |   }
      187 |   
      188 |   async resetGame() {

      at MockGameEngine.loadGame (tests/mocks/game-engine.mock.js:185:11)
      at Object.loadGame (tests/save-load.test.js:376:24)

  â— Save/Load System â€º Performance and Scalability â€º should handle large save files efficiently

    Save file not found

      183 |       return Promise.resolve()
      184 |     }
    > 185 |     throw new Error('Save file not found')
          |           ^
      186 |   }
      187 |   
      188 |   async resetGame() {

      at MockGameEngine.loadGame (tests/mocks/game-engine.mock.js:185:11)
      at Object.loadGame (tests/save-load.test.js:409:24)

  â— Save/Load System â€º Performance and Scalability â€º should maintain performance with multiple saves

    expect(received).toBeLessThan(expected)

    Expected: < 0
    Received:   0

      439 |       
      440 |       // Second half shouldn't be much slower than first half
    > 441 |       expect(avgSecond).toBeLessThan(avgFirst * 3)
          |                         ^
      442 |     })
      443 |   })
      444 |   

      at Object.toBeLessThan (tests/save-load.test.js:441:25)

  â— Save/Load System â€º Edge Cases and Error Recovery â€º should handle saves with special characters

    Save file not found

      183 |       return Promise.resolve()
      184 |     }
    > 185 |     throw new Error('Save file not found')
          |           ^
      186 |   }
      187 |   
      188 |   async resetGame() {

      at MockGameEngine.loadGame (tests/mocks/game-engine.mock.js:185:11)
      at Object.loadGame (tests/save-load.test.js:487:24)

FAIL tests/story-engine.test.js
  Story Engine Narrative Flow
    Scene Navigation
      âœ“ should start at intro scene
      âœ“ should get current chapter (1 ms)
      âœ“ should navigate to specific scene
      âœ“ should handle invalid navigation
      âœ“ should unlock scenes when navigated to
    Choice System
      âœ“ should make valid choice
      âœ“ should handle invalid choice
      âœ“ should record choice in history (1 ms)
      âœ• should apply consequences of choices
      âœ• should set story flags
    Available Choices
      âœ“ should get available choices for current scene
      âœ“ should filter choices based on conditions
      âœ“ should handle scene with no choices
    Prerequisites and Access Control
      âœ“ should check scene accessibility
      âœ“ should deny access to scenes with unmet prerequisites (1 ms)
      âœ“ should grant access after meeting prerequisites
    Story State Management
      âœ“ should get complete story state
      âœ“ should set story state
      âœ“ should preserve existing state when setting partial state (1 ms)
    Character Relationships
      âœ• should track relationship changes
      âœ“ should enforce relationship bounds
    Story Flags
      âœ• should set and check story flags
      âœ“ should persist flags across choices (1 ms)
    Branching Path Analysis
      âœ• should analyze possible branching paths
      âœ• should find all reachable scenes
    Choice History
      âœ“ should maintain chronological choice history
      âœ“ should include scene context in choice history
    Story Reset
      âœ“ should reset story to initial state (1 ms)
      âœ“ should return to intro scene after reset
    Edge Cases
      âœ“ should handle missing scene gracefully
      âœ“ should handle choice when no current scene
      âœ“ should handle malformed consequences (1 ms)
    Performance Tests
      âœ“ should handle large choice history efficiently
      âœ• should analyze branching paths efficiently

  â— Story Engine Narrative Flow â€º Choice System â€º should apply consequences of choices

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: undefined

      384 |       
      385 |       const state = storyEngine.getStoryState()
    > 386 |       expect(state.characterRelationships.ravi).toBe(10)
          |                                                 ^
      387 |     })
      388 |     
      389 |     test('should set story flags', () => {

      at Object.toBe (tests/story-engine.test.js:386:49)

  â— Story Engine Narrative Flow â€º Choice System â€º should set story flags

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      391 |       
      392 |       const state = storyEngine.getStoryState()
    > 393 |       expect(state.storyFlags.has('friendly_player')).toBe(true)
          |                                                       ^
      394 |     })
      395 |   })
      396 |   

      at Object.toBe (tests/story-engine.test.js:393:55)

  â— Story Engine Narrative Flow â€º Character Relationships â€º should track relationship changes

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: undefined

      488 |       
      489 |       const state = storyEngine.getStoryState()
    > 490 |       expect(state.characterRelationships.ravi).toBe(10)
          |                                                 ^
      491 |       
      492 |       storyEngine.makeChoice('continue')
      493 |       storyEngine.makeChoice('be_sarcastic') // If this were possible

      at Object.toBe (tests/story-engine.test.js:490:49)

  â— Story Engine Narrative Flow â€º Story Flags â€º should set and check story flags

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      518 |       
      519 |       const state = storyEngine.getStoryState()
    > 520 |       expect(state.storyFlags.has('friendly_player')).toBe(true)
          |                                                       ^
      521 |       expect(state.storyFlags.has('sarcastic_player')).toBe(false)
      522 |     })
      523 |     

      at Object.toBe (tests/story-engine.test.js:520:55)

  â— Story Engine Narrative Flow â€º Branching Path Analysis â€º should analyze possible branching paths

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      536 |       
      537 |       expect(Array.isArray(paths)).toBe(true)
    > 538 |       expect(paths.length).toBeGreaterThan(0)
          |                            ^
      539 |       
      540 |       // Should find multiple paths through the story
      541 |       expect(paths.some(path => path.includes('intro_2'))).toBe(true)

      at Object.toBeGreaterThan (tests/story-engine.test.js:538:28)

  â— Story Engine Narrative Flow â€º Branching Path Analysis â€º should find all reachable scenes

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      551 |       })
      552 |       
    > 553 |       expect(allScenes.has('intro_1')).toBe(true)
          |                                        ^
      554 |       expect(allScenes.has('intro_2')).toBe(true)
      555 |       expect(allScenes.has('intro_3')).toBe(true)
      556 |     })

      at Object.toBe (tests/story-engine.test.js:553:40)

  â— Story Engine Narrative Flow â€º Performance Tests â€º should analyze branching paths efficiently

    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      663 |       
      664 |       expect(endTime - startTime).toBeLessThan(100)
    > 665 |       expect(paths.length).toBeGreaterThan(0)
          |                            ^
      666 |     })
      667 |   })
      668 | })

      at Object.toBeGreaterThan (tests/story-engine.test.js:665:28)

FAIL tests/cross-platform.test.js
  Cross-Platform Compatibility
    Operating System Compatibility
      âœ“ should detect current platform correctly
      âœ“ should handle different path separators (1 ms)
      âœ“ should handle different line endings
    Node.js Version Compatibility
      âœ“ should run on supported Node.js versions
      âœ“ should handle different JavaScript engine features
      âœ“ should use appropriate APIs for the environment
    Terminal Compatibility
      âœ“ should handle different terminal capabilities (553 ms)
      âœ“ should handle different console widths gracefully (838 ms)
      âœ“ should work without color support (223 ms)
    File System Compatibility
      âœ“ should handle different file permissions (1 ms)
      âœ“ should handle different filesystem types (1 ms)
    Memory and Resource Limits
      âœ“ should respect system memory limits
      âœ“ should handle low memory conditions gracefully (1 ms)
      âœ“ should handle CPU limitations (1 ms)
    Network and Connectivity
      âœ“ should handle offline operation (1 ms)
      âœ“ should handle network timeouts gracefully (101 ms)
    Character Encoding
      âœ“ should handle different character encodings (2 ms)
      âœ“ should handle different locale settings (11 ms)
    Environment Variables
      âœ“ should handle missing environment variables (1 ms)
      âœ• should respect debug environment variables (2 ms)
    Performance Across Platforms
      âœ“ should maintain consistent performance
      âœ“ should scale with system capabilities (1 ms)
    Error Handling Across Platforms
      âœ“ should handle platform-specific errors
      âœ“ should provide platform-appropriate error messages

  â— Cross-Platform Compatibility â€º Environment Variables â€º should respect debug environment variables

    Hooks cannot be defined inside tests. Hook of type "beforeEach" is nested within "should respect debug environment variables".

      148 |
      149 | // Test environment setup
    > 150 | beforeEach(() => {
          | ^
      151 |   // Clear all mocks before each test
      152 |   jest.clearAllMocks()
      153 |   

      at eventHandler (node_modules/jest-circus/build/eventHandler.js:97:11)
      at Object.beforeEach (tests/setup.js:150:1)
      at require (tests/cross-platform.test.js:421:13)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at toThrow (tests/cross-platform.test.js:422:18)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/cross-platform.test.js:413:19)

  â— Cross-Platform Compatibility â€º Environment Variables â€º should respect debug environment variables

    Hooks cannot be defined inside tests. Hook of type "afterEach" is nested within "should respect debug environment variables".

      156 | })
      157 |
    > 158 | afterEach(() => {
          | ^
      159 |   // Clean up any test artifacts
      160 |   jest.restoreAllMocks()
      161 | })

      at eventHandler (node_modules/jest-circus/build/eventHandler.js:97:11)
      at Object.afterEach (tests/setup.js:158:1)
      at require (tests/cross-platform.test.js:421:13)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at toThrow (tests/cross-platform.test.js:422:18)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/cross-platform.test.js:413:19)

  â— Cross-Platform Compatibility â€º Environment Variables â€º should respect debug environment variables

    Hooks cannot be defined inside tests. Hook of type "beforeEach" is nested within "should respect debug environment variables".

      169 | const testStartTimes = new Map()
      170 |
    > 171 | beforeEach(() => {
          | ^
      172 |   const testName = expect.getState().currentTestName
      173 |   testStartTimes.set(testName, Date.now())
      174 | })

      at eventHandler (node_modules/jest-circus/build/eventHandler.js:97:11)
      at Object.beforeEach (tests/setup.js:171:1)
      at require (tests/cross-platform.test.js:421:13)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at toThrow (tests/cross-platform.test.js:422:18)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/cross-platform.test.js:413:19)

  â— Cross-Platform Compatibility â€º Environment Variables â€º should respect debug environment variables

    Hooks cannot be defined inside tests. Hook of type "afterEach" is nested within "should respect debug environment variables".

      174 | })
      175 |
    > 176 | afterEach(() => {
          | ^
      177 |   const testName = expect.getState().currentTestName
      178 |   const startTime = testStartTimes.get(testName)
      179 |   if (startTime) {

      at eventHandler (node_modules/jest-circus/build/eventHandler.js:97:11)
      at Object.afterEach (tests/setup.js:176:1)
      at require (tests/cross-platform.test.js:421:13)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at toThrow (tests/cross-platform.test.js:422:18)
          at Array.forEach (<anonymous>)
      at Object.forEach (tests/cross-platform.test.js:413:19)

FAIL tests/e2e.test.js
  End-to-End User Experience
    Complete Game Session
      âœ“ should handle full gameplay session from start to save (1 ms)
      âœ“ should handle player mistakes and recovery
      âœ• should maintain consistency across session
    Multi-Session Continuity
      âœ• should maintain continuity across save/load cycles (1 ms)
      âœ• should handle multiple save slots
    Character Development
      âœ“ should show character growth throughout session (1 ms)
      âœ• should remember character knowledge
    Performance Under Load
      âœ“ should handle extended gameplay session (1 ms)
      âœ“ should handle rapid user input (4 ms)
    User Experience Edge Cases
      âœ“ should handle empty or whitespace commands (1 ms)
      âœ“ should handle very long input gracefully
      âœ“ should handle special characters in commands
    Accessibility and Usability
      âœ“ should provide helpful error messages (1 ms)
      âœ“ should maintain consistent response format
    Data Integrity
      âœ“ should maintain data integrity throughout session
      âœ“ should handle concurrent state access safely (1 ms)

  â— End-to-End User Experience â€º Complete Game Session â€º should maintain consistency across session

    expect(received).toContain(expected) // indexOf

    Expected substring: "living room"
    Received string:    "You go south to the Living Room."

      100 |           testUtils.createMockCommand(action.command, action.args)
      101 |         )
    > 102 |         expect(response).toContain(action.expected)
          |                          ^
      103 |       }
      104 |       
      105 |       // Verify final state consistency

      at Object.toContain (tests/e2e.test.js:102:26)

  â— End-to-End User Experience â€º Multi-Session Continuity â€º should maintain continuity across save/load cycles

    Save file not found

      183 |       return Promise.resolve()
      184 |     }
    > 185 |     throw new Error('Save file not found')
          |           ^
      186 |   }
      187 |   
      188 |   async resetGame() {

      at MockGameEngine.loadGame (tests/mocks/game-engine.mock.js:185:11)
      at Object.loadGame (tests/e2e.test.js:129:24)

  â— End-to-End User Experience â€º Multi-Session Continuity â€º should handle multiple save slots

    Save file not found

      183 |       return Promise.resolve()
      184 |     }
    > 185 |     throw new Error('Save file not found')
          |           ^
      186 |   }
      187 |   
      188 |   async resetGame() {

      at MockGameEngine.loadGame (tests/mocks/game-engine.mock.js:185:11)
      at Object.loadGame (tests/e2e.test.js:170:26)

  â— End-to-End User Experience â€º Character Development â€º should remember character knowledge

    Save file not found

      183 |       return Promise.resolve()
      184 |     }
    > 185 |     throw new Error('Save file not found')
          |           ^
      186 |   }
      187 |   
      188 |   async resetGame() {

      at MockGameEngine.loadGame (tests/mocks/game-engine.mock.js:185:11)
      at Object.loadGame (tests/e2e.test.js:226:24)

PASS tests/swarm-coordination.test.js
  Swarm Coordination
    Hook Integration
      âœ“ should execute pre-task hooks successfully (1 ms)
      âœ“ should execute post-edit hooks after state changes
      âœ“ should execute notification hooks for significant events
      âœ“ should execute post-task hooks on completion (1 ms)
    Memory Coordination
      âœ“ should store game progress in swarm memory
      âœ“ should retrieve coordination context from memory
      âœ“ should coordinate between multiple game sessions
    Agent Communication
      âœ“ should communicate game events to swarm agents
      âœ“ should receive guidance from analytical agents
      âœ“ should coordinate with testing agents for quality assurance (1 ms)
    Performance Monitoring
      âœ“ should monitor game performance metrics
      âœ“ should detect performance bottlenecks
    Adaptive Behavior
      âœ“ should adapt to player behavior patterns
      âœ“ should learn from player feedback
    Error Handling and Recovery
      âœ“ should handle hook execution failures gracefully (2 ms)
      âœ“ should recover from swarm communication failures
      âœ“ should maintain game functionality without swarm (1 ms)
    Data Synchronization
      âœ“ should synchronize game state with swarm memory
      âœ“ should handle concurrent access to shared state
    Integration Testing
      âœ“ should integrate with full swarm workflow
      âœ“ should coordinate with external systems (1 ms)

FAIL tests/integration.test.js
  Integration: Complete Gameplay Flow
    Game Initialization
      âœ“ should initialize complete game system (1 ms)
      âœ“ should start interactive mode successfully
    Complete User Journey: New Player
      âœ“ should handle complete new player experience (1 ms)
      âœ• should handle player making mistakes gracefully
    Complete User Journey: Returning Player
      âœ• should handle save and load cycle
      âœ“ should handle loading non-existent save gracefully (1 ms)
    Ravi Integration
      âœ“ should have Ravi respond to all game events (1 ms)
      âœ“ should track Ravi's mood changes throughout gameplay
    Command Parser Integration
      âœ“ should handle complex command sequences
      âœ“ should handle rapid command input (1 ms)
    Error Recovery
      âœ• should recover from invalid game states
      âœ“ should handle character disconnection
    Performance Integration
      âœ“ should maintain performance during extended play (1 ms)
      âœ“ should handle concurrent operations (2 ms)
    Swarm Coordination Integration
      âœ“ should coordinate with swarm hooks
      âœ“ should share game progress with swarm memory
    Edge Cases in Integration
      âœ• should handle rapid save/load cycles
      âœ“ should handle memory exhaustion gracefully (718 ms)
      âœ“ should maintain data integrity across operations

  â— Integration: Complete Gameplay Flow â€º Complete User Journey: New Player â€º should handle player making mistakes gracefully

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      120 |       
      121 |       // Game should still be functional
    > 122 |       expect(gameEngine.getState().isRunning).toBe(true)
          |                                               ^
      123 |     })
      124 |   })
      125 |   

      at Object.toBe (tests/integration.test.js:122:47)

  â— Integration: Complete Gameplay Flow â€º Complete User Journey: Returning Player â€º should handle save and load cycle

    Save file not found

      183 |       return Promise.resolve()
      184 |     }
    > 185 |     throw new Error('Save file not found')
          |           ^
      186 |   }
      187 |   
      188 |   async resetGame() {

      at MockGameEngine.loadGame (tests/mocks/game-engine.mock.js:185:11)
      at Object.loadGame (tests/integration.test.js:142:24)

  â— Integration: Complete Gameplay Flow â€º Error Recovery â€º should recover from invalid game states

    TypeError: Cannot read properties of undefined (reading 'description')

      113 |     switch (cmd) {
      114 |     case 'look':
    > 115 |       return this.getCurrentLocation().description
          |                                       ^
      116 |       
      117 |     case 'go':
      118 |       const direction = args[0]

      at MockGameEngine.processCommand (tests/mocks/game-engine.mock.js:115:39)
      at Object.processCommand (tests/integration.test.js:253:41)

  â— Integration: Complete Gameplay Flow â€º Edge Cases in Integration â€º should handle rapid save/load cycles

    Save file not found

      183 |       return Promise.resolve()
      184 |     }
    > 185 |     throw new Error('Save file not found')
          |           ^
      186 |   }
      187 |   
      188 |   async resetGame() {

      at MockGameEngine.loadGame (tests/mocks/game-engine.mock.js:185:11)
      at Object.loadGame (tests/integration.test.js:382:28)

FAIL tests/performance.test.js
  Performance Testing
    Command Processing Performance
      âœ“ should process commands within performance thresholds (1 ms)
      âœ“ should handle rapid command sequences efficiently (1 ms)
      âœ“ should maintain performance with complex game states (1 ms)
    Memory Usage Performance
      âœ“ should not leak memory during normal gameplay (1 ms)
      âœ“ should handle large inventories efficiently (723 ms)
      âœ“ should efficiently manage Ravi knowledge base (149 ms)
    Response Time Performance
      âœ“ should generate Ravi responses quickly (1 ms)
      âœ“ should handle mood changes efficiently (1 ms)
      âœ“ should scale well with relationship complexity (7 ms)
    Save/Load Performance
      âœ“ should save game state efficiently (3 ms)
      âœ• should load game state efficiently (1 ms)
    Concurrent Operations Performance
      âœ“ should handle simultaneous operations efficiently (1 ms)
      âœ“ should maintain performance under load
    Scaling Performance
      âœ• should scale linearly with inventory size (6 ms)
      âœ“ should scale well with knowledge base size (27 ms)
    Resource Cleanup Performance
      âœ“ should clean up resources efficiently on reset (297 ms)
      âœ“ should handle memory cleanup during garbage collection (133 ms)
    Edge Case Performance
      âœ“ should handle edge case inputs efficiently (1 ms)
      âœ“ should maintain performance with corrupted state

  â— Performance Testing â€º Save/Load Performance â€º should load game state efficiently

    Save file not found

      183 |       return Promise.resolve()
      184 |     }
    > 185 |     throw new Error('Save file not found')
          |           ^
      186 |   }
      187 |   
      188 |   async resetGame() {

      at MockGameEngine.loadGame (tests/mocks/game-engine.mock.js:185:11)
      at loadGame (tests/performance.test.js:184:26)
      at GameTestHelpers.measurePerformance (tests/utils/test-helpers.js:168:7)
      at Object.<anonymous> (tests/performance.test.js:182:23)

  â— Performance Testing â€º Scaling Performance â€º should scale linearly with inventory size

    expect(received).toBeLessThan(expected)

    Expected: < NaN
    Received:   Infinity

      256 |       
      257 |       // Ratios shouldn't increase dramatically (allowing for some variance)
    > 258 |       expect(ratio2to3).toBeLessThan(ratio1to2 * 3)
          |                         ^
      259 |       expect(ratio3to4).toBeLessThan(ratio2to3 * 3)
      260 |     })
      261 |     

      at Object.toBeLessThan (tests/performance.test.js:258:25)

FAIL tests/command-parser.test.js
  Command Parser Functionality
    Basic Parsing
      âœ“ should parse simple command
      âœ“ should parse command with arguments (1 ms)
      âœ“ should parse command with multiple arguments
      âœ“ should handle case insensitive input
      âœ“ should trim whitespace
      âœ“ should handle multiple spaces between words
    Command Aliases
      âœ“ should resolve single letter aliases (1 ms)
      âœ“ should resolve word aliases
      âœ“ should handle aliases with arguments
    Directional Commands
      âœ“ should convert direction words to go commands
      âœ“ should handle directional aliases
    Compound Commands
      âœ“ should handle "go to" commands
      âœ“ should handle "pick up" commands (1 ms)
      âœ“ should handle "talk to" commands
    Command Validation
      âœ“ should validate known commands (1 ms)
      âœ“ should reject unknown commands
      âœ“ should mark valid commands in parse result
      âœ“ should mark invalid commands in parse result
    Error Handling
      âœ• should handle empty input
      âœ“ should handle whitespace-only input
      âœ“ should handle null input
      âœ“ should handle undefined input
      âœ“ should handle non-string input
    Alias Management
      âœ“ should add new alias for valid command
      âœ“ should reject alias for invalid command
      âœ“ should remove existing alias
      âœ“ should handle removing non-existent alias
      âœ“ should get all aliases
    Command Information
      âœ“ should get all valid commands
      âœ“ should return copy of valid commands array
    Complex Input Scenarios
      âœ“ should handle quoted strings
      âœ“ should handle commands with punctuation
      âœ“ should handle very long input
      âœ“ should handle special characters
    Performance Tests
      âœ“ should parse commands quickly (1 ms)
      âœ“ should handle command with many arguments efficiently
    Edge Cases
      âœ“ should handle command with only spaces as arguments
      âœ“ should handle commands with tabs and newlines
      âœ“ should handle unicode characters (1 ms)
      âœ“ should handle numbers in arguments

  â— Command Parser Functionality â€º Error Handling â€º should handle empty input

    expect(received).toContain(expected) // indexOf

    Expected substring: "Empty command"
    Received string:    "Invalid input"

      296 |       expect(result.args).toEqual([])
      297 |       expect(result.isValid).toBe(false)
    > 298 |       expect(result.error).toContain('Empty command')
          |                            ^
      299 |     })
      300 |     
      301 |     test('should handle whitespace-only input', () => {

      at Object.toContain (tests/command-parser.test.js:298:28)

FAIL tests/cli.test.js (43.356 s)
  CLI Interface
    Command Line Argument Parsing
      âœ“ should show help when requested (191 ms)
      âœ“ should show version when requested (203 ms)
      âœ“ should start game normally without arguments (193 ms)
    Interactive Mode
      âœ“ should handle basic commands in interactive mode (5002 ms)
      âœ• should handle quit command gracefully (3008 ms)
    File Operations
      âœ• should handle save command (5003 ms)
      âœ• should handle invalid commands gracefully (3006 ms)
    Error Handling
      âœ• should handle SIGINT gracefully (3003 ms)
      âœ• should handle rapid input without crashing (5007 ms)
    Cross-Platform Compatibility
      âœ• should handle different line endings (3003 ms)
      âœ“ should work with different node versions (1 ms)
    Output Formatting
      âœ• should produce colored output when supported (256 ms)
      âœ“ should handle ASCII art display (211 ms)
    Performance Tests
      âœ“ should start within reasonable time (198 ms)
      âœ• should handle multiple simultaneous instances (5005 ms)
    Memory Management
      âœ• should not leak memory during normal operation (10002 ms)

  â— CLI Interface â€º Interactive Mode â€º should handle quit command gracefully

    expect(received).toContain(expected) // indexOf

    Expected substring: "room"
    Received string:    "  ___             _  _        _       _                 _Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
     | _ \\ __ _ __ __(_)( )___   /_\\   __| |__ __ ___  _ _ | |_  _  _  _ _  ___Â·
     |   // _` |\\ V /| ||/(_-<  / _ \\ / _` |\\ V // -_)| ' \\|  _|| || || '_|/ -_)
     |_|_\\\\__,_| \\_/ |_|  /__/ /_/ \\_\\\\__,_| \\_/ \\___||_||_|\\__| \\_,_||_|  \\___|Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
    A hilarious CLI text adventure featuring Ravi and agentic swarm codingÂ·
    ğŸ® Welcome to a world where NPCs know they're NPCs!Â·
    [32m?[39m [1mWhat should Ravi call you?[22m[0m [0m[2m(Player) [22m[38D[38C"

      103 |       
      104 |       child.on('close', () => {
    > 105 |         expect(output).toContain('room') // Response to look command
          |                        ^
      106 |         done()
      107 |       })
      108 |       

      at ChildProcess.toContain (tests/cli.test.js:105:24)

  â— CLI Interface â€º File Operations â€º should handle save command

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: null

      131 |       
      132 |       child.on('close', (code) => {
    > 133 |         expect(code).toBe(0) // Should exit cleanly
          |                      ^
      134 |         done()
      135 |       })
      136 |       

      at ChildProcess.toBe (tests/cli.test.js:133:22)

  â— CLI Interface â€º File Operations â€º should handle invalid commands gracefully

    expect(received).toMatch(expected)

    Expected pattern: /saved|progress/i
    Received string:  "  ___             _  _        _       _                 _Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
     | _ \\ __ _ __ __(_)( )___   /_\\   __| |__ __ ___  _ _ | |_  _  _  _ _  ___Â·
     |   // _` |\\ V /| ||/(_-<  / _ \\ / _` |\\ V // -_)| ' \\|  _|| || || '_|/ -_)
     |_|_\\\\__,_| \\_/ |_|  /__/ /_/ \\_\\\\__,_| \\_/ \\___||_||_|\\__| \\_,_||_|  \\___|Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
    A hilarious CLI text adventure featuring Ravi and agentic swarm codingÂ·
    ğŸ® Welcome to a world where NPCs know they're NPCs!Â·
    [32m?[39m [1mWhat should Ravi call you?[22m[0m [0m[2m(Player) [22m[38D[38C"

      175 |       
      176 |       child.on('close', async () => {
    > 177 |         expect(output).toMatch(/saved|progress/i)
          |                        ^
      178 |         
      179 |         // Check if save file was created
      180 |         try {

      at ChildProcess.toMatch (tests/cli.test.js:177:24)

  â— CLI Interface â€º Error Handling â€º should handle SIGINT gracefully

    expect(received).toMatch(expected)

    Expected pattern: /understand|unknown|invalid/i
    Received string:  "  ___             _  _        _       _                 _Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
     | _ \\ __ _ __ __(_)( )___   /_\\   __| |__ __ ___  _ _ | |_  _  _  _ _  ___Â·
     |   // _` |\\ V /| ||/(_-<  / _ \\ / _` |\\ V // -_)| ' \\|  _|| || || '_|/ -_)
     |_|_\\\\__,_| \\_/ |_|  /__/ /_/ \\_\\\\__,_| \\_/ \\___||_||_|\\__| \\_,_||_|  \\___|Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·
    A hilarious CLI text adventure featuring Ravi and agentic swarm codingÂ·
    ğŸ® Welcome to a world where NPCs know they're NPCs!Â·
    [32m?[39m [1mWhat should Ravi call you?[22m[0m [0m[2m(Player) [22m[38D[38C"

      216 |       
      217 |       child.on('close', () => {
    > 218 |         expect(output).toMatch(/understand|unknown|invalid/i)
          |                        ^
      219 |         done()
      220 |       })
      221 |       

      at ChildProcess.toMatch (tests/cli.test.js:218:24)

  â— CLI Interface â€º Error Handling â€º should handle rapid input without crashing

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      246 |       child.on('close', (code, signal) => {
      247 |         // Should handle interrupt gracefully
    > 248 |         expect(signal === 'SIGINT' || code === 0).toBe(true)
          |                                                   ^
      249 |         done()
      250 |       })
      251 |       

      at ChildProcess.toBe (tests/cli.test.js:248:51)

  â— CLI Interface â€º Cross-Platform Compatibility â€º should handle different line endings

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: null

      278 |       
      279 |       child.on('close', (code) => {
    > 280 |         expect(code).toBe(0) // Should not crash
          |                      ^
      281 |         done()
      282 |       })
      283 |       

      at ChildProcess.toBe (tests/cli.test.js:280:22)

  â— CLI Interface â€º Output Formatting â€º should produce colored output when supported

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: null

      311 |       
      312 |       child.on('close', (code) => {
    > 313 |         expect(code).toBe(0)
          |                      ^
      314 |         expect(output).toMatch(/room|help/i)
      315 |         done()
      316 |       })

      at ChildProcess.toBe (tests/cli.test.js:313:22)

  â— CLI Interface â€º Performance Tests â€º should handle multiple simultaneous instances

    Game did not start within timeout

      413 |       setTimeout(() => {
      414 |         child.kill()
    > 415 |         done(new Error('Game did not start within timeout'))
          |              ^
      416 |       }, 5000)
      417 |     }, testConstants.TIMEOUT.LONG)
      418 |     

      at Timeout._onTimeout (tests/cli.test.js:415:14)

  â— CLI Interface â€º Memory Management â€º should not leak memory during normal operation

    thrown: "Exceeded timeout of 10000 ms for a test while waiting for `done()` to be called.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

      450 |   
      451 |   describe('Memory Management', () => {
    > 452 |     test('should not leak memory during normal operation', (done) => {
          |     ^
      453 |       const child = spawn('node', [gamePath], { 
      454 |         stdio: ['pipe', 'pipe', 'pipe'] 
      455 |       })

      at test (tests/cli.test.js:452:5)
      at describe (tests/cli.test.js:451:3)
      at Object.describe (tests/cli.test.js:10:1)

